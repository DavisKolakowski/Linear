@model LinearUpdateDashboard.ViewModels.DataIntegrityViewModel

@{
    ViewData["Title"] = "Dashboard";
}

@section Styles {
    <link rel="stylesheet" href="~/lib/vendor/datatables/datatables.min.css"/>    
    <link rel="stylesheet" href="~/lib/vendor/datatables/dist/css/dataTables.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/autofill/css/autoFill.bootstrap5.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/buttons/css/buttons.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/colreorder/css/colReorder.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/datetime/css/dataTables.dateTime.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/fixedcolumns/css/fixedColumns.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/fixedheader/css/fixedHeader.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/keytable/css/keyTable.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/responsive/css/responsive.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/rowgroup/css/rowGroup.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/rowreorder/css/rowReorder.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/scroller/css/scroller.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/searchbuilder/css/searchBuilder.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/searchpanes/css/searchPanes.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/select/css/select.bootstrap5.min.css"/>
    <link rel="stylesheet" href="~/lib/vendor/datatables/extensions/staterestore/css/stateRestore.bootstrap5.min.css"/>
}

@section Scripts {
    <script src="~/lib/vendor/datatables/datatables.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/jszip/jszip.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/pdfmake/pdfmake.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/pdfmake/vfs_fonts.js"></script>
    <script src="~/lib/vendor/datatables/dist/js/jquery.dataTables.min.js"></script>
    <script src="~/lib/vendor/datatables/dist/js/dataTables.bootstrap5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/autofill/js/dataTables.autoFill.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/autofill/js/autoFill.bootstrap5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/buttons/js/buttons.bootstrap5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/buttons/js/buttons.colVis.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/buttons/js/buttons.html5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/buttons/js/buttons.print.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/colreorder/js/dataTables.colReorder.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/datetime/js/dataTables.dateTime.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/fixedcolumns/js/dataTables.fixedColumns.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/fixedheader/js/dataTables.fixedHeader.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/keytable/js/dataTables.keyTable.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/responsive/js/responsive.bootstrap5.js"></script>
    <script src="~/lib/vendor/datatables/extensions/rowgroup/js/dataTables.rowGroup.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/rowreorder/js/dataTables.rowReorder.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/scroller/js/dataTables.scroller.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/searchbuilder/js/dataTables.searchBuilder.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/searchbuilder/js/searchBuilder.bootstrap5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/searchpanes/js/dataTables.searchPanes.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/searchpanes/js/searchPanes.bootstrap5.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/select/js/dataTables.select.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/staterestore/js/dataTables.stateRestore.min.js"></script>
    <script src="~/lib/vendor/datatables/extensions/staterestore/js/stateRestore.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
                var table = $('#DataIntegrityDT').DataTable( {
                    dom: "fBRrtl",
                    responsive: true,
                    searching: false,
                    paging: false,
                    select: true,
                    buttons: [
                        { 
                            extend: 'copy',
                            className: 'btn btn-outline-default btn-sm'
                        },
                        { extend: 'excel', className: 'btn btn-outline-default btn-sm' },
                        { extend: 'pdf', className: 'btn btn-outline-default btn-sm' },
                        {
                            extend: 'spacer',
                            style: 'bar'
                        },
                        { extend: 'selectAll', className: 'btn btn-outline-default btn-sm' },
                        { extend: 'selectNone', className: 'btn btn-outline-default btn-sm' }
                    ],
                    columnDefs: [
                        { responsivePriority: 1, targets: 0 },
                        { responsivePriority: 2, targets: -1 }
                    ],
                    order: [[1, 'asc']],
                    rowGroup: {
                        dataSrc: 1
                    }
                });
           });
    </script>
}

<h1>Data Integrity Dashboard</h1>

<div id="datatable" class="mb-5">
    <table id="DataIntegrityDT" class="table table-bordered text-nowrap w-100" style="text-transform: uppercase;">
        <thead style="text-transform: uppercase;">
            <tr class="table-primary">
                <th>
                    Server Name
                </th>
                <th>
                    Headquarters
                </th>
                <th>
                    Conflict Log
                </th>
                <th>
                    Spot Count
                </th>
                <th>
                    Log Last Update
                </th>
                <th>
                    Last Database Update
                </th>
            </tr>
        </thead>
        <tbody>
    @foreach (var item in Model.HeadquartersDistributionServers.DistributionServers) {
            <tr>
                <td>
                    @item.ServerIdentity
                </td>
                <td>
                    @item.Headquarters.Name
                </td>
                <td>
                    @item.SpotsLogFileName
                </td>
                <td>
                    @Model.DistributionServerSpotCount[item.Id]
                </td>
                <td>
                    @item.SpotsLogLastWriteTime
                </td>
                <td>
                    @item.LastSuccessfulDatabaseJob
                </td>
            </tr>
    }
        </tbody>
    </table>
</div>
